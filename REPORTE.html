<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joyería Venezia - Menú Principal</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        /* --- Variables CSS --- */
        :root {
            --gold: #D4AF37;
            --gold-light: #F5E6C8;
            --dark: #1A1A1A;
            --light: #F8F8F8;
            --gray: #6D6D6D;
            --gray-light: #E8E8E8;
            --transition: all 0.3s ease;
        }

        /* --- Estilos Generales --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background-image: url('https://images.unsplash.com/photo-1605100804763-247f67b3557e?q=80&w=1470&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative; /* Needed for the ::before pseudo-element */
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6); /* Dark overlay */
            z-index: -1;
        }

        /* --- Contenedor del Menú Principal --- */
        .main-menu-container {
            max-width: 600px;
            width: 100%;
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
            padding: 40px;
            text-align: center;
            animation: fadeIn 0.8s ease-out;
            z-index: 1; /* Ensure it's above the overlay */
        }

        /* --- Animación de Entrada --- */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* --- Encabezado del Menú --- */
        .menu-header {
            margin-bottom: 40px;
        }

        .menu-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
        }

        .menu-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: var(--gold);
        }

        .menu-subtitle {
            color: var(--gray);
            font-size: 1rem;
            margin-top: 15px;
        }

        /* --- Opciones del Menú --- */
        .menu-options {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .menu-btn {
            background: var(--dark);
            color: white;
            border: none;
            padding: 18px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            font-family: 'Montserrat', sans-serif;
            text-decoration: none;
            display: block;
        }

        .menu-btn:hover {
            background: var(--gold);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .menu-btn:active {
            transform: translateY(0);
        }

        /* --- Estilo específico para el botón de Clientes Corrientes --- */
        #btnClientesCorrientes {
            background: var(--gold);
            color: var(--dark);
        }

        #btnClientesCorrientes:hover {
            background: #C9A227; /* A slightly darker gold on hover */
            color: white;
        }

        /* --- Media Queries para el Menú Principal --- */
        @media (max-width: 768px) {
            .main-menu-container {
                padding: 30px;
            }

            .menu-title {
                font-size: 2rem;
            }

            .menu-btn {
                padding: 15px 25px;
                font-size: 1rem;
            }
        }

        /* --- Estilos para el Formulario (Certificación de Joyas) --- */
        .container {
            max-width: 1000px;
            width: 100%;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
            display: grid;
            grid-template-columns: 1fr 1.5fr; /* 2 columns: brand and form */
            min-height: 700px;
            animation: fadeIn 0.8s ease-out;
            z-index: 1; /* Ensure it's above the overlay */
        }

        .brand-section {
            background: linear-gradient(135deg, #1A1A1A 0%, #3A3A3A 100%);
            color: white;
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
        }

        .brand-section::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--gold), transparent);
        }

        .logo {
            width: 180px;
            margin-bottom: 30px;
            filter: brightness(0) invert(1); /* Makes the logo white */
        }

        .brand-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--gold);
        }

        .form-section {
            padding: 50px 40px;
            overflow-y: auto; /* Enable scrolling for forms that are too long */
            max-height: 700px; /* Limit height to prevent form from exceeding container */
        }

        .form-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .form-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
        }

        .form-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 2px;
            background: var(--gold);
        }

        .form-subtitle {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Two columns for form fields */
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: span 2; /* Make this group span both columns */
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--dark);
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: 6px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9rem;
            transition: var(--transition);
            background-color: white;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2);
        }

        textarea {
            min-height: 120px;
            resize: vertical; /* Allow vertical resizing */
        }

        .fixed-value {
            background-color: var(--gray-light);
            padding: 12px 15px;
            border-radius: 6px;
            font-size: 0.9rem;
            color: var(--dark); /* Ensure text is readable */
            font-weight: 500;
        }

        .submit-btn {
            background: var(--gold);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            margin-top: 20px;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            font-family: 'Montserrat', sans-serif;
        }

        .submit-btn:hover {
            background: #C9A227; /* Slightly darker gold */
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        /* --- Media Queries para el Formulario --- */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr; /* Stack columns on smaller screens */
            }

            .brand-section {
                padding: 30px 20px;
            }

            .form-section {
                padding: 30px 20px;
            }

            .form-grid {
                grid-template-columns: 1fr; /* Single column for form fields */
            }

            .form-group.full-width {
                grid-column: span 1; /* Reset full-width to single column */
            }
        }

        /* --- Estilos para Select (Dropdown) --- */
        select {
            /* Remove default arrow and add custom SVG arrow */
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 15px;
        }

        /* --- Estilos de Scrollbar Personalizados --- */
        .form-section::-webkit-scrollbar {
            width: 6px;
        }

        .form-section::-webkit-scrollbar-track {
            background: var(--gray-light);
        }

        .form-section::-webkit-scrollbar-thumb {
            background: var(--gold);
            border-radius: 3px;
        }
    </style>
</head>

<body>
    <div class="main-menu-container" id="mainMenu">
        <div class="menu-header">
            <h1 class="menu-title">Bienvenido a Joyería Venezia</h1>
            <p class="menu-subtitle">Seleccione una opción para continuar</p>
        </div>
        <div class="menu-options">
            <button class="menu-btn" onclick="loadContent('vip')">Clientes VIP</button>
            <button class="menu-btn" id="btnClientesCorrientes" onclick="loadContent('corrientes')">Clientes Corrientes</button>
            <button class="menu-btn" onclick="loadContent('certificado')">Certificado Joyas</button>
        </div>
    </div>

    <div id="contentContainer" style="display: none; justify-content: center; align-items: center; width: 100%;"></div>

    <script>
        // Define the scriptURL globally
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyGOQoM-LdQ3MeRJcPyF2fXsGchS0outVt0QUbRtzFfu5Ctq2_fsV0kj7ImDaD889EX/exec';

        function loadContent(option) {
            const mainMenu = document.getElementById('mainMenu');
            const contentContainer = document.getElementById('contentContainer');

            mainMenu.style.display = 'none';
            contentContainer.innerHTML = ''; // Clear any previous content

            if (option === 'corrientes') {
                contentContainer.style.display = 'flex'; // Use flex to center the form
                contentContainer.innerHTML = `
                    <div class="container">
                        <div class="brand-section">
                            <img src="https://joyeriavenezia.com/wp-content/uploads/2021/11/joyeria-venezia-logo-c.svg" alt="Joyería Venezia" class="logo">
                            <h1 class="brand-title">Certificación de Joyas</h1>
                        </div>

                        <div class="form-section">
                            <div class="form-header">
                                <h2 class="form-title">Formulario de Certificación</h2>
                                <p class="form-subtitle">Complete todos los campos requeridos para generar el certificado</p>
                            </div>

                            <form id="reporteForm">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="reporte_numero">Número de Reporte</label>
                                        <input type="text" id="reporte_numero" name="reporte_numero" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="gramos_oro">Gramos de Oro</label>
                                        <input type="text" id="gramos_oro" name="gramos_oro" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="gramos_plata">Gramos de Plata</label>
                                        <input type="text" id="gramos_plata" name="gramos_plata" required>
                                    </div>

                                    <div class="form-group">
                                        <label>Ley del Oro</label>
                                        <div class="fixed-value">18kt ley 750</div>
                                        <input type="hidden" name="ley_oro" value="18kt ley 750">
                                    </div>

                                    <div class="form-group">
                                        <label for="color_oro">Color del Oro</label>
                                        <select id="color_oro" name="color_oro" required>
                                            <option value="">Seleccione un color</option>
                                            <option value="Amarillo">Amarillo</option>
                                            <option value="Rosado">Rosado</option>
                                            <option value="Blanco">Blanco</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Ley de la Plata</label>
                                        <div class="fixed-value">Ley 950</div>
                                        <input type="hidden" name="ley_plata" value="Ley 950">
                                    </div>

                                    <div class="form-group">
                                        <label for="tipo_piedra">Tipo de Piedra</label>
                                        <select id="tipo_piedra" name="tipo_piedra" required>
                                            <option value="">Seleccione un tipo</option>
                                            <option value="Diamante">Diamante</option>
                                            <option value="Esmeralda">Esmeralda</option>
                                            <option value="Zafiro">Zafiro</option>
                                            <option value="Rubí">Rubí</option>
                                            <option value="Corindones">Corindones</option>
                                            <option value="Amatista">Amatista</option>
                                            <option value="Topacio">Topacio</option>
                                            <option value="Peridoto">Peridoto</option>
                                            <option value="Granate">Granate</option>
                                            <option value="Rodolita">Rodolita</option>
                                            <option value="Praciolita">Praciolita</option>
                                            <option value="Citrino">Citrino</option>
                                            <option value="Moissanita">Moissanita</option>
                                            <option value="DiamanteCrecidoEnLaboratorio">Diamante crecido en laboratorio</option>
                                            <option value="DiamanteNatural">Diamante natural</option>
                                            <option value="DiamanteTratadoNatural">Diamante tratado natural</option>
                                            <option value="Vidrio">Vidrio</option>
                                            <option value="Aguamarina">Aguamarina</option>
                                            <option value="Moisannita">Moisannita</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="cantidad_piedra">Cantidad de Piedras</label>
                                        <input type="number" id="cantidad_piedra" name="cantidad_piedra" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="talla_piedra">Talla de la Piedra</label>
                                        <input type="text" id="talla_piedra" name="talla_piedra" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="calidad_piedra">Calidad de la Piedra</label>
                                        <select id="calidad_piedra" name="calidad_piedra" required>
                                            <option value="">Seleccione una calidad</option>
                                            <option value="Extra">Extra</option>
                                            <option value="A">A</option>
                                            <option value="AA">AA</option>
                                            <option value="AAA">AAA</option>
                                            <option value="AAAA">AAAA</option>
                                            <option value="Buena">Buena</option>
                                            <option value="I1">I1</option>
                                            <option value="SI2">SI2</option>
                                            <option value="I3">I3</option>
                                            <option value="VS1">VS1</option>
                                            <option value="VVS2">VVS2</option>
                                            <option value="SI1">SI1</option>
                                            <option value="Natural">Natural</option>
                                            <option value="Sintético">Sintético</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="forma_piedra">Forma de la Piedra</label>
                                        <select id="forma_piedra" name="forma_piedra" required>
                                            <option value="">Seleccione una forma</option>
                                            <option value="Redonda">Redonda</option>
                                            <option value="Corazón">Corazón</option>
                                            <option value="Esmeralda">Esmeralda</option>
                                            <option value="Marquis">Marquis</option>
                                            <option value="Ovalado">Ovalado</option>
                                            <option value="Lagrima">Lágrima</option>
                                            <option value="Rectangular">Rectangular</option>
                                            <option value="Óvalo">Óvalo</option>
                                            <option value="Cushion">Cushion</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="color_piedra">Color de la Piedra</label>
                                        <select id="color_piedra" name="color_piedra" required>
                                            <option value="">Seleccione un color</option>
                                            <option value="Blanca">Blanca</option>
                                            <option value="Verde">Verde</option>
                                            <option value="Azul">Azul</option>
                                            <option value="Roja">Roja</option>
                                            <option value="Amarillo">Amarillo</option>
                                            <option value="Naranja">Naranja</option>
                                            <option value="Rosada">Rosada</option>
                                            <option value="Amarillooscuro">Amarillo oscuro</option>
                                            <option value="Azulvivo">Azul vivo</option>
                                            <option value="Azulmuyclaro">Azul muy claro</option>
                                            <option value="Irradiado">Irradiado</option>
                                            <option value="Pink">Pink</option>
                                            <option value="Sapphire blue">Sapphire blue</option>
                                            <option value="Lemon Yellow">Lemon Yellow</option>
                                            <option value="Light Green">Light Green</option>
                                            <option value="Dark Green">Dark Green</option>
                                            <option value="Red">Red</option>
                                            <option value="RangoU-Vcaféclaro">Rango U-V café claro</option>
                                            <option value="S-T">S-T</option>
                                            <option value="I">I</option>
                                            <option value="K">K</option>
                                            <option value="H">H</option>
                                            <option value="G">G</option>
                                            <option value="Negro">Negro</option>
                                            <option value="F">F</option>
                                            <option value="N">N</option>
                                            <option value="J">J</option>
                                            <option value="E">E</option>
                                            <option value="Verdevívido">Verde vívido</option>
                                            <option value="Verdemedio">Verde medio</option>
                                            <option value="VerdeMedio">Verde Medio</option>
                                            <option value="VerdeIntenso">Verde Intenso</option>
                                            <option value="AzulProfundo">Azul Profundo</option>
                                            <option value="RojoPúrpuraProfundo">Rojo Púrpura Profundo</option>
                                            <option value="Singraduacióndecolorporrellenodefisuras">Sin gradación de color por relleno de fisuras</option>
                                            <option value="Natural">Natural</option>
                                            <option value="Azulintenso">Azul intenso</option>
                                            <option value="Rojointenso">Rojo intenso</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="origen_piedra">Origen de la Piedra</label>
                                        <input type="text" id="origen_piedra" name="origen_piedra" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="medida_piedra_mm">Medida de la Piedra (mm)</label>
                                        <input type="text" id="medida_piedra_mm" name="medida_piedra_mm" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="quilataje_total_ct">Quilataje Total (Ct)</label>
                                        <input type="text" id="quilataje_total_ct" name="quilataje_total_ct" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="grabado_interno">Grabado Interno</label>
                                        <input type="text" id="grabado_interno" name="grabado_interno" required>
                                    </div>
                                    
                                    <div class="form-group full-width">
                                        <label for="imagen">Imagen del Producto (Opcional)</label>
                                        <input type="file" id="imagen" name="imagen" accept="image/*">
                                    </div>

                                    <div class="form-group full-width">
                                        <label for="codigo_qr">URL del Código QR (Opcional)</label>
                                        <input type="url" id="codigo_qr" name="codigo_qr">
                                    </div>

                                    <div class="form-group full-width">
                                        <label for="descripcion_producto">Descripción del Producto</label>
                                        <textarea id="descripcion_producto" name="descripcion_producto" required></textarea>
                                    </div>
                                </div>

                                <button type="submit" class="submit-btn">Generar Certificado</button>
                                <button type="button" class="submit-btn" style="background-color: var(--gray); margin-top: 10px;" onclick="goBackToMenu()">Volver al Menú</button>
                                <p id="loadingMessage" style="display: none; text-align: center; margin-top: 10px; color: var(--gold); font-weight: bold;">Enviando información, por favor espere...</p>
                            </form>
                        </div>
                    </div>
                `;
                // IMPORTANT: Call setupFormListener AFTER the form HTML is injected
                setupFormListener();
            } else if (option === 'certificado') { // Logic for the 'Certificado Joyas' button (search form)
                contentContainer.style.display = 'flex';
                contentContainer.innerHTML = `
                    <div class="container">
                        <div class="brand-section">
                            <img src="https://joyeriavenezia.com/wp-content/uploads/2021/11/joyeria-venezia-logo-c.svg" alt="Joyería Venezia" class="logo">
                            <h1 class="brand-title">Buscar Certificado</h1>
                        </div>
                        <div class="form-section">
                            <div class="form-header">
                                <h2 class="form-title">Ver Certificado Existente</h2>
                                <p class="form-subtitle">Ingresa el número de reporte para buscar el certificado.</p>
                            </div>
                            <form id="searchForm">
                                <div class="form-group full-width">
                                    <label for="search_reporte_numero">Número de Reporte</label>
                                    <input type="text" id="search_reporte_numero" name="reporte_numero" required>
                                </div>
                                <button type="submit" class="submit-btn">Buscar Certificado</button>
                                <button type="button" class="submit-btn" style="background-color: var(--gray); margin-top: 10px;" onclick="goBackToMenu()">Volver al Menú</button>
                            </form>
                            <div id="searchResult" style="margin-top: 20px; text-align: center;"></div>
                        </div>
                    </div>
                `;
                setupSearchListener(); // Call setupSearchListener after injecting the search form
            } else {
                // For other options ('vip'), display a simple message
                contentContainer.style.display = 'flex';
                contentContainer.innerHTML = `
                    <div class="main-menu-container">
                        <div class="menu-header">
                            <h2 class="menu-title">${option === 'vip' ? 'Clientes VIP' : 'Certificado Joyas'}</h2>
                            <p class="menu-subtitle">Funcionalidad en desarrollo para esta sección.</p>
                        </div>
                        <button class="menu-btn" onclick="goBackToMenu()">Volver al Menú Principal</button>
                    </div>
                `;
            }
        }

        function goBackToMenu() {
            document.getElementById('mainMenu').style.display = 'flex';
            document.getElementById('contentContainer').style.display = 'none';
            document.getElementById('contentContainer').innerHTML = ''; // Clear content when going back
        }

        // Function to set up the form submission listener for the certificate generation
        function setupFormListener() {
            const form = document.getElementById('reporteForm');
            const loadingMessage = document.getElementById('loadingMessage');
            const submitButton = form.querySelector('.submit-btn'); // Get the submit button specifically

            if (form) { // Check if the form actually exists
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();

                    submitButton.disabled = true; // Disable button
                    submitButton.textContent = 'Enviando...'; // Change button text
                    loadingMessage.style.display = 'block'; // Show loading message

                    // Create FormData object from the form
                    const formData = new FormData(form);
                    
                    // Remove the image file from FormData if present
                    if (formData.get('imagen')) {
                        formData.delete('imagen');
                    }

                    try {
                        const response = await fetch(scriptURL, {
                            method: 'POST',
                            body: formData,
                            redirect: 'follow'
                        });

                        loadingMessage.style.display = 'none'; // Hide loading message

                        if (response.ok) {
                            const data = await response.json();
                            if (data.success) {
                                alert('Certificado generado exitosamente. Los datos se han registrado correctamente.');
                                form.reset(); // Clear the form fields
                            } else {
                                alert('Error al generar el certificado: ' + data.message);
                            }
                        } else {
                            throw new Error(`Error en la respuesta del servidor: ${response.status} ${response.statusText}`);
                        }
                    } catch (error) {
                        loadingMessage.style.display = 'none'; // Ensure loading message is hidden on error
                        console.error('Error:', error);
                        alert('Ocurrió un error al procesar el certificado. Por favor, inténtalo de nuevo: ' + error.message);
                    } finally {
                        submitButton.disabled = false; // Re-enable button
                        submitButton.textContent = 'Generar Certificado'; // Restore button text
                    }
                });
            }
        }

        // Function to set up the search form submission listener
        function setupSearchListener() {
            const searchForm = document.getElementById('searchForm');
            const searchResultDiv = document.getElementById('searchResult');

            if (searchForm) {
                searchForm.addEventListener('submit', async function(e) {
                    e.preventDefault();

                    const searchReporteNumero = document.getElementById('search_reporte_numero').value;
                    searchResultDiv.innerHTML = 'Buscando...'; // Show loading message

                    try {
                        const response = await fetch(`${scriptURL}?reporte_numero=${encodeURIComponent(searchReporteNumero)}`);
                        const result = await response.json(); // Parse the JSON response

                        if (result.success) {
                            searchResultDiv.innerHTML = `<p style="color: green;">✅ Certificado encontrado:</p><p><a href="${result.url}" target="_blank" class="menu-btn" style="display:inline-block; margin-top: 10px; width: auto; padding: 10px 20px;">Ver Certificado</a></p>`;
                        } else {
                            searchResultDiv.innerHTML = `<p style="color: red;">${result.message}</p>`;
                        }
                    } catch (error) {
                        console.error('Error al buscar certificado:', error);
                        searchResultDiv.innerHTML = '<p style="color: red;">Ocurrió un error al buscar el certificado. Por favor, inténtalo de nuevo.</p>';
                    }
                });
            }
        }
    </script>
</body>

</html>
