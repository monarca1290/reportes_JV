<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Certificados - Joyería Venezia</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root {
            --gold: #D4AF37; --dark: #1A1A1A; --light: #F8F8F8;
            --gray: #6D6D6D; --gray-light: #E8E8E8; --transition: all 0.3s ease;
        }
        body {
            font-family: 'Montserrat', sans-serif; background-color: var(--light);
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; padding: 20px;
            background-image: url('https://images.unsplash.com/photo-1605100804763-247f67b3557e?q=80&w=1470&auto=format&fit=crop');
            background-size: cover; background-position: center; background-attachment: fixed;
        }
        body::before {
            content: ''; position: fixed; top: 0; left: 0;
            width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6);
        }
        .container {
            max-width: 1000px; width: 100%; background: white; border-radius: 15px;
            overflow: hidden; box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
            display: grid; grid-template-columns: 1fr 1.5fr; min-height: 700px;
            animation: fadeIn 0.8s ease-out; z-index: 1;
        }
        .brand-section {
            background: linear-gradient(135deg, #1A1A1A 0%, #3A3A3A 100%); color: white; padding: 40px;
            display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;
        }
        .logo { width: 180px; margin-bottom: 30px; filter: brightness(0) invert(1); }
        .brand-title { font-family: 'Playfair Display', serif; font-size: 2.2rem; color: var(--gold); }
        .form-section { padding: 40px; overflow-y: auto; max-height: 80vh; }
        .form-title { font-family: 'Playfair Display', serif; font-size: 1.8rem; margin-bottom: 20px; text-align: center; color: var(--dark); }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .form-group { margin-bottom: 15px; }
        .form-group.full-width { grid-column: span 2; }
        label { display: block; margin-bottom: 8px; font-weight: 500; }
        input, select, textarea {
            width: 100%; padding: 12px 15px; border: 1px solid var(--gray-light);
            border-radius: 6px; font-family: 'Montserrat', sans-serif; transition: var(--transition);
        }
        input:focus, select:focus, textarea:focus {
            outline: none; border-color: var(--gold); box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2);
        }
        textarea { min-height: 100px; resize: vertical; }
        .fixed-value { background-color: var(--gray-light); padding: 12px 15px; border-radius: 6px; font-weight: 500; }
        .submit-btn {
            background: var(--gold); color: white; border: none; padding: 15px;
            font-size: 1rem; font-weight: 600; border-radius: 8px; cursor: pointer;
            transition: var(--transition); width: 100%; text-transform: uppercase;
        }
        .submit-btn:hover { background: #C9A227; transform: translateY(-2px); }
        .submit-btn:disabled { background-color: var(--gray); cursor: not-allowed; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
            .form-grid { grid-template-columns: 1fr; }
            .form-group.full-width { grid-column: span 1; }
            .form-section { max-height: none; }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="brand-section">
            <img src="https://joyeriavenezia.com/wp-content/uploads/2021/11/joyeria-venezia-logo-c.svg" alt="Joyería Venezia" class="logo">
            <h1 class="brand-title">Certificación de Joyas</h1>
        </div>

        <div class="form-section">
            <h2 class="form-title">Formulario de Certificación</h2>

            <form id="reporteForm">
                <div class="form-grid">
                    <div class="form-group"><label for="reporte_numero">Número de Reporte</label><input type="text" id="reporte_numero" name="reporte_numero" required></div>
                    <div class="form-group"><label for="gramos_oro">Gramos de Oro</label><input type="text" id="gramos_oro" name="gramos_oro" required></div>
                    <div class="form-group"><label for="gramos_plata">Gramos de Plata</label><input type="text" id="gramos_plata" name="gramos_plata" required></div>
                    <div class="form-group"><label>Ley del Oro</label><div class="fixed-value">18kt ley 750</div><input type="hidden" name="ley_oro" value="18kt ley 750"></div>
                    <div class="form-group"><label>Ley de la Plata</label><div class="fixed-value">Ley 950</div><input type="hidden" name="ley_plata" value="Ley 950"></div>
                    <div class="form-group"><label for="tipo_piedra">Tipo de Piedra</label><input type="text" id="tipo_piedra" name="tipo_piedra" required></div>
                    <div class="form-group"><label for="cantidad_piedra">Cantidad de Piedras</label><input type="number" id="cantidad_piedra" name="cantidad_piedra" required></div>
                    <div class="form-group"><label for="talla_piedra">Talla de la Piedra</label><input type="text" id="talla_piedra" name="talla_piedra" required></div>
                    <div class="form-group"><label for="calidad_piedra">Calidad de la Piedra</label><input type="text" id="calidad_piedra" name="calidad_piedra" required></div>
                    <div class="form-group"><label for="forma_piedra">Forma de la Piedra</label><input type="text" id="forma_piedra" name="forma_piedra" required></div>
                    <div class="form-group"><label for="color_piedra">Color de la Piedra</label><input type="text" id="color_piedra" name="color_piedra" required></div>
                    <div class="form-group"><label for="origen_piedra">Origen de la Piedra</label><input type="text" id="origen_piedra" name="origen_piedra" required></div>
                    <div class="form-group"><label for="medida_piedra_mm">Medida Piedra (mm)</label><input type="text" id="medida_piedra_mm" name="medida_piedra_mm" required></div>
                    <div class="form-group"><label for="quilataje_total_ct">Quilataje Total (Ct)</label><input type="text" id="quilataje_total_ct" name="quilataje_total_ct" required></div>
                    <div class="form-group full-width"><label for="grabado_interno">Grabado Interno</label><input type="text" id="grabado_interno" name="grabado_interno"></div>
                    
                    <div class="form-group full-width"><label for="descripcion_producto">Descripción del Producto</label><textarea id="descripcion_producto" name="descripcion_producto" required></textarea></div>
                    <input type="hidden" name="codigo_qr" value=""> </div>
                <div class="form-group full-width">
                     <button type="submit" class="submit-btn" id="submitBtn">Guardar Registro</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const form = document.getElementById('reporteForm');
        const submitBtn = document.getElementById('submitBtn');
        
        // ***************************************************************
        // ** PEGA AQUÍ LA URL DE DESPLIEGUE DE TU GOOGLE APPS SCRIPT    **
        // ***************************************************************
        const scriptURL = 'URL_DE_TU_SCRIPT_AQUI'; 

        form.addEventListener('submit', e => {
            e.preventDefault();
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'Enviando...';
            
            Swal.fire({
                title: 'Guardando registro...',
                text: 'Por favor, espere.',
                allowOutsideClick: false,
                didOpen: () => { Swal.showLoading(); }
            });
            
            // new FormData(form) funciona igual sin el campo de la imagen.
            fetch(scriptURL, { method: 'POST', body: new FormData(form)})
                .then(response => response.json())
                .then(data => {
                    if(data.success) {
                        Swal.fire({ icon: 'success', title: '¡Éxito!', text: data.message });
                        form.reset();
                    } else {
                         Swal.fire({ icon: 'error', title: 'Error', text: data.message });
                    }
                })
                .catch(error => {
                    Swal.fire({
                        icon: 'error', title: 'Error de Conexión',
                        text: 'No se pudo contactar al servidor. Error: ' + error.message,
                    });
                })
                .finally(() => {
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Guardar Registro';
                });
        });
    </script>
</body>
</html>
